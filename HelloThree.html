<html>
	<head>
		<title>Three.js app</title>
		<style>canvas { width: 100%; height: 100% }</style>
	</head>
	<body>
		<script src="https://rawgithub.com/mrdoob/three.js/master/build/three.js"></script>
		<script src="resources/jquery-1.11.0.min.js"></script>
		<script src="resources/OrbitControls.js"></script>
		<script>
			var scene;
			var camera;
			var renderer;
			var frameCount = 0;
			var controls;
			var starShape, extrudemesh, material;
			var numBasePoints;
			var numpoints;
			var scale = 0;

			$(document).ready(function() {	
			init();
			animate();
	
			function init() {
				scene = new THREE.Scene();

				var light = new THREE.DirectionalLight( 0xffffff );
				light.position.set( 0, 0, 1 );
				scene.add( light );
			
				camera = new THREE.PerspectiveCamera( 75, 
									window.innerWidth / window.innerHeight,
									0.1,
									1000 );

				controls = new THREE.OrbitControls(camera);

				renderer = new THREE.WebGLRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				document.body.appendChild( renderer.domElement );

				camera.position.set(0, 0, 5);
				drawExtrudeForm();	
			}
		
/*			$("canvas").click(function(){
				console.log("camera at " + camera.position.x + " , " +
							camera.position.y + " , " + 
							camera.position.z); 

 
			}); */
		
			function drawExtrudeForm() {
				// init extrude form
				var starpts = [];
				var pts = [], starPoints = 5, l;
				for ( i = 0; i < starPoints * 2; i ++ ) {

					if ( i % 2 == 1 ) {

						l = 0.5;

					} else {
						l = 1;

					}

					var a = i / starPoints * Math.PI;
					starpts.push( new THREE.Vector2 ( Math.cos( a ) * l, Math.sin( a ) * l ) );

				}

				var angle = (2 * Math.PI)/50;
				for (i = 0; i < 50; i++) {
					var x = Math.cos(angle * i);
					var y = Math.sin(angle * i);
					pts.push( new THREE.Vector2(x,y));
				}
				
				var splinePts = [];
				var sangle = (2 * Math.PI)/10;
				for (i = 0; i < 10; i++) {
					var x = Math.cos(angle * i * 2);
					var y = Math.sin(angle * i * 2);
					var z = i;
					splinePts.push( new THREE.Vector3(x, y, z));
				}				

				var spline = new THREE.SplineCurve3(splinePts);
				starShape = new THREE.Shape(starpts);
				var extrudeSettings = { amount: 0.1,  bevelEnabled: false, 
							 steps:10 /*, extrudePath: spline*/};			   
				var star3d = starShape.extrude(extrudeSettings);
				material = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true} );
				extrudemesh = new THREE.Mesh(star3d, material);
				extrudemesh.geometry.dynamic = true; 
				scene.add(extrudemesh);	
				numpoints = extrudemesh.geometry.vertices.length;
				numBasePoints = starpts.length;
				console.log("numpoints = " + numpoints + " numbasepoints = " + numBasePoints);
				console.log(numpoints/numBasePoints);
			}
			
			function animate() {
				requestAnimationFrame(animate);
				render();
			}

			function render() {

				if (scale < 10) {
					for (i = 1; i < numpoints/numBasePoints; i++ ) {
						for (j = 0; j < numBasePoints; j++) {
							var ind = i * numBasePoints + j;
							extrudemesh.geometry.vertices[ind].z += 0.01 * i;
						}
					} 
					scale ++;
				}

				extrudemesh.geometry.verticesNeedUpdate = true;
				renderer.render(scene, camera);
				frameCount++;
			}
			
});
		</script>
	</body>	
</html>
